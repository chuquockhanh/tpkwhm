CREATE TABLE UserRegion (
  UserRegionID BIGINT NOT NULL AUTO_INCREMENT,
  UserID BIGINT NOT NULL,
  RegionID BIGINT NOT NULL,

  PRIMARY KEY (UserRegionID),
  UNIQUE `UQ_UserRegion`(UserID ASC, RegionID ASC),
  CONSTRAINT `FK_UserRegion_User` FOREIGN KEY(UserID) REFERENCES `User`(UserID) ON DELETE CASCADE ON UPDATE NO ACTION,
  CONSTRAINT `FK_UserRegion_Region` FOREIGN KEY(RegionID) REFERENCES `Region`(RegionID) ON DELETE CASCADE ON UPDATE NO ACTION
)ENGINE = InnoDB;

ALTER TABLE AuditSchedule ADD COLUMN `CreatedBy` BIGINT NULL;
ALTER TABLE AuditSchedule ADD CONSTRAINT `FK_AuditSchedule_User` FOREIGN KEY (CreatedBy) REFERENCES `User`(UserID) ON DELETE CASCADE ON UPDATE NO ACTION;


ALTER TABLE Auditor ADD COLUMN `CreatedBy` BIGINT NULL;
ALTER TABLE Auditor ADD CONSTRAINT `FK_Auditor_User` FOREIGN KEY (CreatedBy) REFERENCES `User`(UserID) ON DELETE CASCADE ON UPDATE NO ACTION;

ALTER TABLE Distributor ADD COLUMN `CreatedBy` BIGINT NULL;
ALTER TABLE Distributor ADD CONSTRAINT `FK_Distributor_User` FOREIGN KEY (CreatedBy) REFERENCES `User`(UserID) ON DELETE SET NULL ON UPDATE NO ACTION;

ALTER TABLE Outlet ADD COLUMN `CreatedBy` BIGINT NULL;
ALTER TABLE Outlet ADD CONSTRAINT `FK_Outlet_User` FOREIGN KEY (CreatedBy) REFERENCES `User`(UserID) ON DELETE SET NULL ON UPDATE NO ACTION;


UPDATE AuditSchedule SET CreatedBy = 2;
UPDATE Auditor SET CreatedBy = 2;
UPDATE Distributor SET CreatedBy = 2;
UPDATE Outlet SET CreatedBy = 2;
